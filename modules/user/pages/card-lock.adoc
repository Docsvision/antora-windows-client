= Управление блокировкой карточек и файлов

_Блокировкой_ называется состояние карточки {dv}, при котором она открыта для редактирования одним из сотрудников и доступна только для просмотра всем остальным пользователям.

Все элементы, за исключением файлов, блокируются временно, на период редактирования. Блокировка снимается с элемента, когда его закрывает редактирующий его пользователь или администратор в принудительном порядке.

Файлы, прикрепленные к карточке документа, могут блокироваться как временно, что происходит при открытии их пользователями, так и постоянно, при выборе из контекстного меню опции _Заблокировать_.

Администратор может просмотреть список всех заблокированных элементов системы, а также принудительно снять блокировку элемента, открытого кем-либо из пользователей для редактирования.

При аварийном выходе из системы блокировка открытых пользователем карточек сохраняется, что позволяет ему вновь войти в систему и продолжить начатую работу.

[#lock-list]
== Просмотр списка заблокированных элементов

Просмотр списка всех заблокированных элементов системы доступен только пользователям, обладающим правами администратора. Пользователь, не имеющий таких прав, может просматривать список только тех карточек и файлов, которые заблокированы им самим.

.Чтобы просмотреть список заблокированных элементов:
. Откройте РМА.
. Выберите в главном меню menu:Сервис[Блокировки], чтобы открыть диалоговое окно _Блокировки_. В окне _Блокировки_ отображаются две вкладки: _Карточки_ и _Файлы_.
+
Вкладка Карточки::
Cодержит информацию о заблокированных карточках:
+
** Тип карточки.
** Дайджест карточки.
** Учетная запись пользователя, заблокировавшего карточку.
** Вид блокировки.
+
.Вкладка "Карточки" в диалоговом окне "Блокировки"
image::locks-cards.png[Вкладка "Карточки" в диалоговом окне "Блокировки"]
+
Вкладка Файлы::
Содержит названия блокированных файлов, а также учетные записи пользователей и вид блокировки (временная или постоянная).
+
.Вкладка "Файлы" в диалоговом окне "Блокировки"
image::locks-files.png[Вкладка "Файлы" в диалоговом окне "Блокировки"]
+
[NOTE]
====
При открытии файла блокируется сам файл, его карточка и карточка с описанием его дерева версий.

.Таким образом при открытии карточки файла в список блокировок добавляется сразу три элемента:
* Два элемента на вкладке _Карточки_. Один из них -- элемент со стандартным названием _Карточка файла с версиями_.
* Один элемент на вкладке _Файлы_.
====

Карточки и файлы, заблокированные пользователем, открывшим окно _Блокировки_, выделяются жирным шрифтом.

[#force-unlock]
== Принудительное разблокирование элемента

Администратор может принудительно снять блокировку элемента, открытого кем-либо из пользователей для редактирования.

[WARNING]
====
{dv} не оповещает пользователей о том, что их блокировка снята администратором.

Это поведение делает возможной ситуацию, когда несколько пользователей одновременно изменяют один объект. В таком случае в карточке или файле будут сохранены изменения последнего пользователя.
====

.Чтобы принудительно разблокировать элемент:
. Откройте РМА.
. Выберите в главном меню menu:Сервис[Блокировки].
+
.Вкладка "Карточки" в диалоговом окне "Блокировки"
image::locks-cards.png[Вкладка "Карточки" в диалоговом окне "Блокировки"]
+
. В окне _Блокировки_ выделите в списке нужную карточку и нажмите кнопку *Разблокировать*.
+
[NOTE]
====
Чтобы разблокировать файл, прикрепленный к карточке файла, администратор должен снять блокировку не только с файла, но и с карточки файла и с карточки версий файла.
====

[#refresh-locks]
== Обновление списка блокировок

.Чтобы обновить список блокировок:
. Откройте РМА.
. Выберите в главном меню menu:Сервис[Блокировки].
+
.Вкладка "Карточки" в диалоговом окне "Блокировки"
image::locks-cards.png[Вкладка "Карточки" в диалоговом окне "Блокировки"]
+
. В окне _Блокировки_ выделите в списке нужную карточку и нажмите кнопку *Обновить*.

[#lock-unlock]
== Блокирование и разблокирование файлов документа

Файлы, прикрепленные к карточке документа, могут блокироваться *временно* или *постоянно*.

*Временная* блокировка происходит при открытии карточки пользователем.

.Постоянная блокировка активируется вручную:
. Чтобы включить *постоянную* блокировку, пользователь должен выделить в карточке нужный файл и выбрать из его контекстного меню опцию _Заблокировать_.
. Система предложит пользователю выбрать имя файла для сохранения в файловой системе.
+
Сохранение в файловой системе позволит вносить изменения в заблокированный файл в любой момент, не входя в систему {dv}.

.Чтобы разблокировать файлы, сохранённые в файловой системе:
. Выберите из контекстного меню заблокированного файла команду _Сохранить изменения и разблокировать_
. Чтобы отменить произведенные в файле изменения, выберите команду _Отменить блокировку_.
