= Установка и настройка

.В комплект установки модуля входит:
. Пакет установки серверной части модуля: `{dv} WindowsClient server.msi`.
. Пакет установки клиентской части модуля: `{dv} WindowsClient.msi`.

[#browser-settings]
== Настройка веб-браузера

.Если веб-браузером по умолчанию является Internet Explorer:
. Откройте меню menu:Сервис[Свойства браузера].
. Перейдите в раздел _Безопасность_.
. Добавьте адрес сервера {dv} в _Надежные сайты_.
. Откройте параметры безопасности зоны надежных сайтов нажатием на кнопку *Другое* и измените значения настроек:
+
* menu:Проверка подлинности пользователя[Вход] на *Автоматический вход в сеть с текущим именем пользователя и паролем*.
* menu:Элементы ActiveX и модули подключения[Использование элементов управления ActiveX, не помеченных как безопасные для использования] в значение *Включить*.
* menu:Элементы ActiveX и модули подключения[Разрешить запуск элементов управления ActiveX, которые не использовались ранее, без предупреждения] в значение *Включить*.
* menu:Элементы ActiveX и модули подключения[Запуск элементов ActiveX и модулей подключения] в значение *Включить*.
+
. При запуске {wincl}а в некоторых операционных системах в браузере Internet Explorer версии 11 могут возникнуть проблемы, так как по умолчанию в браузере отключены элементы ActiveX.
+
В этом случае в настройках Internet Explorer рекомендуется включить режим совместимости для адреса сервера {dv}:
+
.. Откройте меню menu:Сервис[Параметры просмотра в режиме совместимости].
.. Добавьте адрес сервера {dv} в список сайтов с режимом совместимости.
+
. Если основным веб-браузером системы является Google Chrome, установите расширение xref:install-plugin.adoc[согласно инструкции] {dv} Windows Client Launcher для веб-браузера -- это позволит открывать карточки по ссылке.
+
.. Откройте меню _Настройки_ в Google Chrome.
.. Введите в строке поиска настроек текст "Не отключать работающие в фоновом режиме сервисы при закрытии браузера"
.. Установите переключатель настройки "Не отключать работающие в фоновом режиме сервисы при закрытии браузера" в положение *Включено*.
+
.Настройка работы сервисов в фоновом режиме при закрытии браузера
image::install-chrome-addon.png[Настройка работы сервисов в фоновом режиме при закрытии браузера]
+
. Если основным веб-браузером системы является Google Chrome или Opera, произвести следующие действия (потребуются права локального администратора), иначе возможно некорректное поведение {wincl}а при печати:
+
.. Откройте в редакторе реестра ветку `HKEY_CLASSES_ROOT\.htm`.
.. Узнайте значение ключа `По умолчанию/Default` в открытой ветке.
+
****
Возможные значения: `ChromeHTML` или `OperaStable`.
****
+
.. Выполните (от имени администратора) в командной строке команду:
+
[source]
----
REG ADD HKCR\[YYYY]\shell\printto\command /ve /t REG_EXPAND_SZ /d "rundll32.exe %windir%\system32\mshtml.dll,PrintHTML \"%1\" \"%2\" \"%3\" \"%4\"" /f <.>
----
<.> `YYYY` -- полученное в п. b значение (`ChromeHTML` или `OperaStable`).

[#install-server]
== Установка серверной части модуля

Серверная часть модуля {wincl} должна быть установлена на машину с серверными компонентами {dv}.

NOTE: Пользователь, выполняющий установку, должен обладать правами локального администратора.

. Запустите пакет установки `{dv} WindowsClient server.msi`.
+
.Мастер установки серверной части модуля {wincl}
image::install-hello.png[Мастер установки серверной части модуля {wincl}]
+
. Примите условия лицензионного соглашения для продолжения установки.
+
.Условия лицензионного соглашения
image::install-license.png[Условия лицензионного соглашения]
+
. Нажмите кнопку *Установить* и дождитесь завершения установки модуля.
+
.Мастер установки серверной части модуля {wincl}
image::install-confirm.png[Мастер установки серверной части модуля {wincl}]
+
. На следующем экране нажмите кнопку *Готово*, чтобы закрыть мастер установки.
. Если данный базовый модуль устанавливается последним, запустите {cns} и выполните настройку системы следуя инструкции, xref:6.1@platform:admin:config-master.adoc[приведённой] в документации модуля {pl}.

[#install-client]
== Установка клиентской части модуля

Клиентская часть модуля {wincl} должна быть установлена на компьютеры пользователей {dv}.

.Клиентская часть может быть установлена двумя способами:
* <<auto,С сервера {dv}>> -- требуемые компоненты будут загружены с сервера {dv} и установлены автоматически.
* <<manual,Из пакета установки>> -- администратор должен вручную установить клиентскую часть модуля {wincl}.

Модуль будет установлен в каталог установки с областью установки модуля {pl}. У пользователя должны быть права на установку с данными условиями.

[#auto]
=== Установка {wincl}а с сервера {dv}

. Откройте веб-браузер Internet Explorer на компьютере пользователя {dv}.
+
[NOTE]
====
Установка с помощью других веб-браузеров не поддерживается.

Internet Explorer должен быть настроен согласно инструкции, приведенной в пункте <<browser-settings,Настройка веб-браузера>>.

Если в программе {cns} для установки клиентской части указана область установки _Для всех пользователей_, Internet Explorer должен быть запущен пользователем с правами администратора компьютера.
====
+
. Перейдите на стартовую страницу {dv}.
+
Адрес стартовой страницы {dv} имеет следующий вид: `\http://имя-сервера-{dv}:ПОРТ`, например `\http://dvserver.company.com:5000`.
+
.Стартовая страница {dv}
image::dv-start-page.png[Стартовая страница {dv}]
+
****
Будут установлены клиентские части модулей {pl} и {wincl} с областью установки, указанной в программе {cns}.

Если установка не начнется автоматически, нажмите в тексте на ссылку с текстом _здесь_.
****
+
. Дождитесь завершения установки.
+
В меню "Пуск" будут добавлены ярлыки для запуска {wincl}а и РМА.
+
При установке с областью "для всех пользователей" также будет выполнена xref:precompile.adoc[предкомпиляция компонентов] сторонних производителей.
+
Если установка с сервера невозможна, воспользуйтесь установкой "{wincl}а" из <<manual,установочного пакета>>.

[#manual]
=== Установка {wincl}а из установочного пакета

. Запустите пакет установки `{dv} WindowsClient.msi`.
+
.Мастер установки модуля {wincl}
image::install-hello-client.png[Мастер установки модуля {wincl}]
+
Для установки клиентской части модуля используется область установки (указана в приветственном окне мастера установки) и каталог установки, которые были использованы при установке модуля {pl}.
+
. Примите условия лицензионного соглашения.
+
.Условия лицензионного соглашения
image::install-license-client.png[Условия лицензионного соглашения]
+
. Выберите дополнительные компоненты для установки.
+
.Устанавливаемые компоненты
image::install-components-client.png[Устанавливаемые компоненты]
+
****
По умолчанию будет установлен компонент _Интеграция с Google Chrome_, который необходим открытия ссылок на карточки {dv} с помощью веб-браузера Google Chrome. +
Если данная возможность не требуется, установку компонента можно отключить.
****
+
. Укажите адрес сервера {dv}, к которому будет подключен {wincl}/РМА.
+
.Адрес подключения к серверу {dv}
image::install-address-client.png[Адрес подключения к серверу {dv}]
+
Адрес сервера {dv} должен быть указан в формате: `\http://имя-сервера-{dv}:ПОРТ`, например `\http://dvserver.company.com:5000`.
+
[NOTE]
====
Пакет установки клиентской части модуля {wincl} может быть запущен с модификатором, позволяющим переопределить значение адреса сервера {dv}. Подробности приведены в пункте xref:mst.adoc[Изменение параметров установки модуля с помощью файла преобразования].
====
+
. Нажмите на кнопку *Установить* и дождитесь завершения установки модуля.
+
.Мастер установки модуля {wincl}
image::install-confirm-client.png[Мастер установки модуля {wincl}]
+
При установке с областью "для всех пользователей" также будет выполнена xref:precompile.adoc[предкомпиляция компонентов] сторонних производителей.
+
. Нажмите на кнопку *Готово*.
+
****
На рабочем столе и в меню Пуск будут размещены ярлыки для запуска {wincl}а и РМА.
****

== Удаление модуля

Компоненты модуля удаляются стандартными средствами ОС. Компоненты модуля следует удалять до удаления компонентов модуля {pl}.

.Удалите:
. _{wincl}_. Сервер.
. _{wincl}_. Клиент.
